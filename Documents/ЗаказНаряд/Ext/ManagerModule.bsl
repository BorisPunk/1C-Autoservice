
Процедура Печать(ТабДок, Ссылка) Экспорт
	//{{_КОНСТРУКТОР_ПЕЧАТИ(Печать)
	Макет = Документы.ЗаказНаряд.ПолучитьМакет("Печать");
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ЗаказНаряд.Автомобиль,
	|	ЗаказНаряд.Дата,
	|	ЗаказНаряд.Заказчик,
	|	ЗаказНаряд.Номер,
	|	ЗаказНаряд.Примечания,
	|	ЗаказНаряд.Пробег,
	|	ЗаказНаряд.Работы.(
	|		НомерСтроки,
	|		Наименование,
	|		Сумма
	|	),
	|	ЗаказНаряд.Материалы.(
	|		НомерСтроки,
	|		Наименование,
	|		Артикул,
	|		Количество,
	|		Цена,
	|		Сумма
	|	)
	|ИЗ
	|	Документ.ЗаказНаряд КАК ЗаказНаряд
	|ГДЕ
	|	ЗаказНаряд.Ссылка В (&Ссылка)";
	Запрос.Параметры.Вставить("Ссылка", Ссылка);
	Выборка = Запрос.Выполнить().Выбрать();

	Шапка 					= Макет.ПолучитьОбласть("Шапка");
	ДанныеАвтомобиля 		= Макет.ПолучитьОбласть("ДанныеАвтомобиля");
	ДанныеЗаказчика 		= Макет.ПолучитьОбласть("ДанныеЗаказчика");	
	ОбластьРаботыШапка 		= Макет.ПолучитьОбласть("РаботыШапка");
	ОбластьРаботыСтрока 	= Макет.ПолучитьОбласть("РаботыСтрока");
	ОбластьРаботыИтого 		= Макет.ПолучитьОбласть("РаботыИтого");
	ОбластьМатериалыШапка 	= Макет.ПолучитьОбласть("МатериалыШапка");
	ОбластьМатериалыСтрока 	= Макет.ПолучитьОбласть("МатериалыСтрока");
	ОбластьМатериалыИтого 	= Макет.ПолучитьОбласть("МатериалыИтого");
	Подвал 					= Макет.ПолучитьОбласть("Подвал");

	ТабДок.Очистить();

	ВставлятьРазделительСтраниц = Ложь;
	Пока Выборка.Следующий() Цикл
		Если ВставлятьРазделительСтраниц Тогда
			ТабДок.ВывестиГоризонтальныйРазделительСтраниц();
		КонецЕсли;
		
		Шапка.Параметры.Номер 						= Выборка.Номер;
		Шапка.Параметры.Дата 						= Формат(Выборка.Дата, "ДЛФ=Д");
		ТабДок.Вывести(Шапка);
		
		ДанныеАвтомобиля.Параметры.Марка 			= Выборка.Автомобиль.Марка;
		ДанныеАвтомобиля.Параметры.Модель 			= Выборка.Автомобиль.Модель;
		ДанныеАвтомобиля.Параметры.Пробег 			= Выборка.Пробег;
		ДанныеАвтомобиля.Параметры.ГосНомер 		= Выборка.Автомобиль.ГосНомер;
		ДанныеАвтомобиля.Параметры.VIN 				= Выборка.Автомобиль.VIN;
		ДанныеАвтомобиля.Параметры.ГодВыпуска 		= Выборка.Автомобиль.ГодВыпуска;
		ДанныеАвтомобиля.Параметры.КодДвигателя 	= Выборка.Автомобиль.КодДвигателя;
		ДанныеАвтомобиля.Параметры.ОбъемДвигателя 	= Выборка.Автомобиль.ОбъемДвигателя;
		ДанныеАвтомобиля.Параметры.ТипДвигателя 	= Выборка.Автомобиль.ТипДвигателя;
		ДанныеАвтомобиля.Параметры.ТипТрансмиссии 	= Выборка.Автомобиль.ТипТрансмиссии;
		ТабДок.Вывести(ДанныеАвтомобиля);
		
		ДанныеЗаказчика.Параметры.ФИО 				= Выборка.Заказчик.ФИО;
		ДанныеЗаказчика.Параметры.Телефон 			= Выборка.Заказчик.Телефон;
		ТабДок.Вывести(ДанныеЗаказчика);

		ТабДок.Вывести(ОбластьРаботыШапка);
		
		ВыборкаРаботы = Выборка.Работы.Выбрать();
		РаботыИтого = 0;
		Пока ВыборкаРаботы.Следующий() Цикл
			ОбластьРаботыСтрока.Параметры.Заполнить(ВыборкаРаботы);
			ТабДок.Вывести(ОбластьРаботыСтрока, ВыборкаРаботы.Уровень());
			РаботыИтого = РаботыИтого + ВыборкаРаботы.Сумма;
		КонецЦикла;
		
		ОбластьРаботыИтого.Параметры.РаботыИтого 	= РаботыИтого;
		ТабДок.Вывести(ОбластьРаботыИтого);

		ТабДок.Вывести(ОбластьМатериалыШапка);
		
		ВыборкаМатериалы = Выборка.Материалы.Выбрать();
		МатериалыИтого = 0;
		Пока ВыборкаМатериалы.Следующий() Цикл
			ОбластьМатериалыСтрока.Параметры.Заполнить(ВыборкаМатериалы);
			ОбластьМатериалыСтрока.Параметры.Артикул = ВыборкаМатериалы.Артикул;
			ТабДок.Вывести(ОбластьМатериалыСтрока, ВыборкаМатериалы.Уровень());
			МатериалыИтого = МатериалыИтого + ВыборкаМатериалы.Сумма;
		КонецЦикла;
		
		ОбластьМатериалыИтого.Параметры.МатериалыИтого = МатериалыИтого;
		ТабДок.Вывести(ОбластьМатериалыИтого);

		Подвал.Параметры.ВсегоРаботы 				= РаботыИтого;
		Подвал.Параметры.ВсегоМатериалы 			= МатериалыИтого;
		Подвал.Параметры.Всего 						= РаботыИтого + МатериалыИтого;
		Подвал.Параметры.Примечания 				= Выборка.Примечания;
		ТабДок.Вывести(Подвал);

		ВставлятьРазделительСтраниц = Истина;
	КонецЦикла;
	//}}
КонецПроцедуры
